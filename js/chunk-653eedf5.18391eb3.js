(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-653eedf5"],{"696f":function(t,e,n){"use strict";n("f8d7")},9761:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t._self._c;return e("div",[e("back-link",{staticClass:"back-link",attrs:{programmatic:"",routes:t.backLinkRoutes}},[t._v("\n    "+t._s(t.$t("GO_BACK"))+"\n  ")]),!t.isPending||t.installationUrl||t.isInstallationFinishedOnDevice?t._e():e("div",{staticClass:"section"},[e("h1",{staticClass:"heading"},[t._v(t._s(t.$t("APP_INSTALLATION_PAGE_HEADING")))]),e("v-message",{staticClass:"section__message",attrs:{type:"warning"}},[t._v(t._s(t.$t("APP_INSTALLATION_PAGE_WARNING")))]),e("v-loader",{staticClass:"section__loader"})],1),t.errorMessage?e("div",{staticClass:"section"},[e("v-message",{attrs:{type:"error"}},[t._v(t._s(t.errorMessage))])],1):t._e(),t.installationUrl||t.jitInProgress||t.isInstallationFinishedOnDevice?e("div",{staticClass:"section"},[t.installationUrl&&!t.isInstallationFinishedOnDevice?e("v-message",{staticClass:"section__message",attrs:{type:"success"}},[t._v(t._s(t.$t("APP_INSTALLATION_PAGE_SUCCESS")))]):t._e(),t.isInstallationFinishedOnDevice?e("v-message",{staticClass:"section__message",attrs:{type:"success"}},[t._v(t._s(t.$t("APP_INSTALLATION_PAGE_SUCCESS_ON_DEVICE")))]):t._e(),t.installationUrl&&!t.isInstallationFinishedOnDevice?e("v-button",{staticClass:"section__button",attrs:{tag:"a",size:"lg",type:"primary",href:t.installationUrl}},[t._v("\n      "+t._s(t.$t("INSTALL"))+"\n    ")]):t._e(),1==t.askForJit?e("div",{staticClass:"jit-section"},[t.currentDevice&&"yes"===t.currentDevice.can_use_jit?e("div",{staticClass:"jit-section__support"},[e("p",{staticClass:"jit-section__notice"},[t._v(t._s(t.$t("JIT_INSTALL_NOTICE")))]),t.jitSucceeded?e("p",{staticClass:"jit-section__success"},[t._v(t._s(t.$t("JIT_ENABLED_SUCCESSFULLY")))]):[t.jitInProgress?t._e():e("v-button",{staticClass:"jit-section__button",attrs:{size:"md",type:"secondary"},on:{click:t.confirmEnableJit}},[t._v("\n            "+t._s(t.$t("ENABLE_JIT_BUTTON"))+"\n          ")])]],2):t.currentDevice&&"no"===t.currentDevice.can_use_jit?e("div",{staticClass:"jit-section__no-support"},[e("html-with-links",{staticClass:"jit-section__notice",attrs:{tag:"p",html:t.$t("JIT_DEVICE_NOT_CONFIGURED_WITH_LINK",{href:"/enable-jit"})}}),t.currentDevice.can_use_jit_validation_error?e("html-with-links",{staticClass:"jit-section__error",attrs:{tag:"p",html:t.currentDevice.can_use_jit_validation_error.translated}}):t._e()],1):t._e()]):t._e()],1):t._e(),e("commands-table",{staticClass:"commands",attrs:{commands:t.commands}}),e("modal",{attrs:{name:"connection-dialog",height:"auto",width:300,adaptive:!0,"click-to-close":!1}},[e("div",{staticClass:"connection-dialog"},[e("div",{staticClass:"connection-dialog__content"},[e("p",[t._v(t._s(t.connectionDialogContent))])]),e("div",{staticClass:"connection-dialog__buttons"},[e("button",{staticClass:"g-button",on:{click:t.handleCancelConnection}},[t._v(t._s(t.$t("CANCEL")))]),e("a",{staticClass:"g-button g-button_primary",attrs:{href:t.shortcutUrl}},[t._v(t._s(t.$t("CONNECT")))])])])])],1)},i=[],r=n("32f42"),a=n("9dd0"),s=n("3680"),c=n("2a7d"),l=n("555f"),u=n("13a2"),d=n("2f62");function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function f(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */f=function(){return e};var t,e={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,o){var r=e&&e.prototype instanceof y?e:y,a=Object.create(r.prototype),s=new x(o||[]);return i(a,"_invoke",{value:L(t,n,s)}),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var m="suspendedStart",g="suspendedYield",p="executing",v="completed",_={};function y(){}function w(){}function b(){}var C={};l(C,a,(function(){return this}));var I=Object.getPrototypeOf,E=I&&I(I(S([])));E&&E!==n&&o.call(E,a)&&(C=E);var P=b.prototype=y.prototype=Object.create(C);function T(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function U(t,e){function n(i,r,a,s){var c=d(t[i],t,r);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==h(u)&&o.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var r;i(this,"_invoke",{value:function(t,o){function i(){return new e((function(e,i){n(t,o,e,i)}))}return r=r?r.then(i,i):i()}})}function L(e,n,o){var i=m;return function(r,a){if(i===p)throw new Error("Generator is already running");if(i===v){if("throw"===r)throw a;return{value:t,done:!0}}for(o.method=r,o.arg=a;;){var s=o.delegate;if(s){var c=N(s,o);if(c){if(c===_)continue;return c}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(i===m)throw i=v,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i=p;var l=d(e,n,o);if("normal"===l.type){if(i=o.done?v:g,l.arg===_)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(i=v,o.method="throw",o.arg=l.arg)}}}function N(e,n){var o=n.method,i=e.iterator[o];if(i===t)return n.delegate=null,"throw"===o&&e.iterator.return&&(n.method="return",n.arg=t,N(e,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),_;var r=d(i,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,_;var a=r.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,_):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,_)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function S(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,r=function n(){for(;++i<e.length;)if(o.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return r.next=r}}throw new TypeError(h(e)+" is not iterable")}return w.prototype=b,i(P,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=l(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,c,"GeneratorFunction")),t.prototype=Object.create(P),t},e.awrap=function(t){return{__await:t}},T(U.prototype),l(U.prototype,s,(function(){return this})),e.AsyncIterator=U,e.async=function(t,n,o,i,r){void 0===r&&(r=Promise);var a=new U(u(t,n,o,i),r);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},T(P),l(P,c,"Generator"),l(P,a,(function(){return this})),l(P,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var o in e)n.push(o);return n.reverse(),function t(){for(;n.length;){var o=n.pop();if(o in e)return t.value=o,t.done=!1,t}return t.done=!0,t}},e.values=S,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(o,i){return s.type="throw",s.arg=e,n.next=o,i&&(n.method="next",n.arg=t),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,_):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),_},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),_}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var i=o.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,o){return this.delegate={iterator:S(e),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=t),_}},e}function m(t,e,n,o,i,r,a){try{var s=t[r](a),c=s.value}catch(l){return void n(l)}s.done?e(c):Promise.resolve(c).then(o,i)}function g(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function a(t){m(r,o,i,a,s,"next",t)}function s(t){m(r,o,i,a,s,"throw",t)}a(void 0)}))}}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){_(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _(t,e,n){return e=y(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(t){var e=w(t,"string");return"symbol"===h(e)?e:String(e)}function w(t,e){if("object"!==h(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!==h(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var b={components:{BackLink:r["a"],CommandsTable:a["a"],VLoader:l["a"],VMessage:s["a"],VButton:c["a"],HtmlWithLinks:u["a"]},data:function(){return{isPending:!0,commands:[],fetchTimeout:null,backLinkRoutes:["app-details","my-apps","my-installation-history"],jitInProgress:!1,shortcutUrl:"shortcuts://run-shortcut?name=connect%20to%20appdb&input=text&text=https%3A%2F%2Fappdb.to%2Fclose.html",activeCommandUuid:null,showingConnectionPrompt:!1,intentionallyNavigatingBack:!1,connectionDialogContent:"",connectionCancelMessage:""}},computed:v(v({},Object(d["d"])(["currentDevice"])),{},{title:function(){return this.$t("APP_INSTALLATION_PAGE_TITLE")},commandUuid:function(){return this.$route.query.commandUuid},askForJit:function(){return this.$route.query.askForJit},historyUuid:function(){return this.$route.query.historyUuid},errorMessage:function(){var t,e=this.commands.find((function(t){return t.status.includes("failed")}));if(e)return(null===(t=e.params)||void 0===t?void 0:t.error)||this.$t("SOMETHING_WENT_WRONG")},manifestUrl:function(){var t,e=this.commands.find((function(t){return"ok"===t.status&&t.params.manifest_uri}));if(e)return null===(t=e.params)||void 0===t?void 0:t.manifest_uri},isInstallationFinishedOnDevice:function(){var t=this.commands.find((function(t){return"ok"===t.status&&t.params.is_installation_finished}));return!!t},jitSucceeded:function(){var t=this.commands.find((function(t){return"ok"===t.status&&"enable_jit"===t.type}));return!!t},installationUrl:function(){if(this.manifestUrl){var t=new URL("itms-services://");return t.searchParams.set("action","download-manifest"),t.searchParams.set("url",this.manifestUrl),t.toString()}}}),methods:{handleCancelConnection:function(){var t=this;return g(f().mark((function e(){var n;return f().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$modal.hide("connection-dialog"),e.prev=1,e.next=4,t.$confirm(t.connectionCancelMessage,{okText:t.$t("YES"),cancelText:t.$t("NO"),hidePage:!0});case 4:if(n=e.sent,!n){e.next=28;break}if(t.showingConnectionPrompt=!1,t.jitInProgress=!1,t.isPending=!1,clearTimeout(t.fetchTimeout),!t.activeCommandUuid){e.next=22;break}return e.prev=11,e.next=14,t.$api.call("cancel_command",{uuid:t.activeCommandUuid});case 14:console.log("Command cancelled successfully:",t.activeCommandUuid),e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](11),console.error("Error cancelling command:",e.t0);case 20:e.next=23;break;case 22:console.log("No active command UUID to cancel on page leave");case 23:window.removeEventListener("beforeunload",t.handleBeforeUnload),t.intentionallyNavigatingBack=!0,t.$router.back(),e.next=30;break;case 28:console.log("User decided to continue the JIT session, showing connection dialog again"),t.$modal.show("connection-dialog");case 30:e.next=36;break;case 32:e.prev=32,e.t1=e["catch"](1),console.log("User decided to continue the JIT session, showing connection dialog again"),t.$modal.show("connection-dialog");case 36:case"end":return e.stop()}}),e,null,[[1,32],[11,17]])})))()},fetchCommands:function(){var t=this;return g(f().mark((function e(){var n,o,i,r;return f().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isPending||t.jitInProgress){e.next=3;break}return console.log("Exiting fetchCommands early - isPending:",t.isPending,"jitInProgress:",t.jitInProgress,"activeCommandUuid:",t.activeCommandUuid),e.abrupt("return");case 3:if(e.prev=3,n=t.activeCommandUuid||t.$route.query.commandUuid,console.log("Fetching commands with UUID:",n),n){e.next=10;break}return console.error("No command UUID available for fetching"),t.jitInProgress||(t.isPending=!1),e.abrupt("return");case 10:return e.prev=10,e.next=13,t.$api.getDeviceStatus({sinceUuid:n});case 13:if(t.commands=e.sent,console.log("Received commands:",t.commands.length,"isPending:",t.isPending,"installationUrl exists:",!!t.installationUrl),o=t.commands.find((function(t){return"ok"===t.status&&t.params.is_installation_finished})),!o){e.next=21;break}return console.log("Installation finished on device, stopping polling"),t.isPending=!1,clearTimeout(t.fetchTimeout),e.abrupt("return");case 21:t.jitInProgress&&(i=t.commands.find((function(t){return"enable_jit"===t.type})),i&&(console.log("Found JIT command with status:",i.status),"waiting_for_connection"!==i.status&&t.showingConnectionPrompt&&(t.$modal.hide("connection-dialog"),t.showingConnectionPrompt=!1,console.log("Connection dialog hidden due to status change to:",i.status)),"waiting_for_connection"!==i.status||t.showingConnectionPrompt||(t.showingConnectionPrompt=!0,t.connectionDialogContent=t.$t("DEVICE_CONNECT_JIT_REQUIREMENT"),t.connectionCancelMessage=t.$t("CONFIRM_CANCEL_JIT_SESSION"),t.$modal.show("connection-dialog")),("ok"===i.status||i.status.match(/failed/))&&(t.jitInProgress=!1,t.showingConnectionPrompt&&(t.$modal.hide("connection-dialog"),t.showingConnectionPrompt=!1),"ok"===i.status?(t.$notify({type:"success",text:t.$t("JIT_ENABLED_SUCCESSFULLY_NOTIFICATION")}),t.isPending=!1,window.removeEventListener("beforeunload",t.handleBeforeUnload),t.intentionallyNavigatingBack=!0,t.$router.back()):t.$notify({type:"error",text:t.$t("JIT_ENABLEMENT_FAILED")})))),r=t.commands.find((function(t){return"install_app"===t.type})),r&&(console.log("Found install_app command with status:",r.status),"waiting_for_connection"!==r.status&&t.showingConnectionPrompt&&(t.$modal.hide("connection-dialog"),t.showingConnectionPrompt=!1,console.log("Connection dialog hidden due to status change to:",r.status)),"waiting_for_connection"!==r.status||t.showingConnectionPrompt||(t.showingConnectionPrompt=!0,t.connectionDialogContent=t.$t("DEVICE_CONNECT_INSTALL_REQUIREMENT"),t.connectionCancelMessage=t.$t("CONFIRM_CANCEL_INSTALL_SESSION"),t.$modal.show("connection-dialog")),("ok"===r.status||r.status.match(/failed/))&&t.showingConnectionPrompt&&(t.$modal.hide("connection-dialog"),t.showingConnectionPrompt=!1)),e.next=31;break;case 26:return e.prev=26,e.t0=e["catch"](10),console.error("API error fetching commands:",e.t0),t.jitInProgress?(t.$notify({type:"error",text:t.$t("ERROR_CHECKING_JIT_STATUS")}),t.jitInProgress=!1):t.isPending&&(t.$notify({type:"error",text:t.$t("ERROR_FETCHING_INSTALLATION_STATUS")}),t.isPending=!1,t.$store.dispatch("router/back",{routes:t.backLinkRoutes})),e.abrupt("return");case 31:clearTimeout(t.fetchTimeout),t.fetchTimeout=setTimeout(t.fetchCommands,1e3),console.log("Scheduling next fetch in 1 second"),e.next=43;break;case 36:e.prev=36,e.t1=e["catch"](3),console.error("Critical error in fetchCommands:",e.t1),t.$notify({type:"error",text:t.$t("UNEXPECTED_ERROR_OCCURRED")}),t.isPending=!1,t.jitInProgress=!1,clearTimeout(t.fetchTimeout);case 43:case"end":return e.stop()}}),e,null,[[3,36],[10,26]])})))()},startPolling:function(){var t=this;console.log("Starting polling cycle with UUID:",this.activeCommandUuid),this.activeCommandUuid?(clearTimeout(this.fetchTimeout),this.fetchTimeout=setTimeout((function(){t.fetchCommands()}),1e3)):console.error("Cannot start polling: no activeCommandUuid available")},validateQuery:function(){var t=this.$route.query.commandUuid;console.log("validateQuery - route commandUuid:",t),t?(this.activeCommandUuid=t,console.log("activeCommandUuid set to:",this.activeCommandUuid)):(this.isPending=!1,this.$store.dispatch("router/back",{routes:this.backLinkRoutes}))},handleDataChange:function(){(this.errorMessage||this.installationUrl||this.isInstallationFinishedOnDevice)&&!this.jitInProgress&&(this.isPending=!1)},handleBeforeUnload:function(t){t.preventDefault()},confirmEnableJit:function(){var t=this;return g(f().mark((function e(){var n;return f().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$store.getters.canInstallApps){e.next=4;break}return e.next=3,t.$alert(t.$t("TO_ENABLE_JIT_VISIT_FROM_DEVICE",{device:t.config.nice_idevice_model}));case 3:return e.abrupt("return");case 4:return e.prev=4,e.next=7,t.$confirm(t.$t("CONFIRM_APP_INSTALLED"),{okText:t.$t("YES"),cancelText:t.$t("NO"),hidePage:!0});case 7:n=e.sent,n&&t.startEnableJitSession(),e.next=13;break;case 11:e.prev=11,e.t0=e["catch"](4);case 13:case"end":return e.stop()}}),e,null,[[4,11]])})))()},startEnableJitSession:function(){var t=this;this.jitInProgress=!0,console.log("Starting JIT session with history UUID:",this.historyUuid),this.$api.call("start_enable_jit_session",{installation_uuid:this.historyUuid}).then((function(e){console.log("JIT session API response:",e),e&&e.command_uuid?(console.log("Received new command UUID:",e.command_uuid),t.activeCommandUuid=e.command_uuid,console.log("Starting polling immediately with UUID:",t.activeCommandUuid),t.startPolling(),console.log("Updating route with new command UUID"),t.$router.replace({query:v(v({},t.$route.query),{},{commandUuid:t.activeCommandUuid})}).catch((function(t){console.error("Error updating route:",t)}))):(console.error("No command UUID received in API response:",e),t.$notify({type:"error",text:t.$t("FAILED_START_JIT_SESSION")}),t.jitInProgress=!1)})).catch((function(e){console.error("Error starting JIT session:",e),t.$notify({type:"error",text:t.$t("FAILED_START_JIT_SESSION")}),t.jitInProgress=!1}))}},watch:{errorMessage:function(){this.handleDataChange()},installationUrl:function(){this.handleDataChange()},isInstallationFinishedOnDevice:function(){this.handleDataChange()},isPending:function(){this.isPending||this.jitInProgress||(window.removeEventListener("beforeunload",this.handleBeforeUnload),clearTimeout(this.fetchTimeout))},jitInProgress:function(t){console.log("jitInProgress changed to:",t,"isPending:",this.isPending,"installationUrl:",!!this.installationUrl),t&&!this.isPending&&window.addEventListener("beforeunload",this.handleBeforeUnload)}},created:function(){console.log("Component created with commandUuid:",this.$route.query.commandUuid),window.addEventListener("beforeunload",this.handleBeforeUnload),this.validateQuery();var t=this.$route.query,e=t.askForJit,n=t.enableJit;"1"===e&&"1"===n&&this.$route.query.commandUuid&&(console.log("Detected external redirect for JIT enablement"),this.jitInProgress=!0,this.historyUuid=this.$route.query.historyUuid,console.log("JIT is in progress, waiting for command status before showing dialog")),this.startPolling()},beforeDestroy:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload),clearTimeout(this.fetchTimeout)},beforeRouteLeave:function(t,e,n){var o=this;return g(f().mark((function t(){return f().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!o.intentionallyNavigatingBack&&(o.isPending||o.jitInProgress)){t.next=2;break}return t.abrupt("return",n());case 2:return t.prev=2,t.next=5,o.$confirm(o.$t("APP_INSTALLATION_PAGE_LEAVE_CONFIRMATION"),{okText:o.$t("YES"),hidePage:!0});case 5:if(!o.activeCommandUuid){t.next=17;break}return t.prev=6,t.next=9,o.$api.call("cancel_command",{uuid:o.activeCommandUuid});case 9:console.log("Command cancelled successfully on page leave:",o.activeCommandUuid),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](6),console.error("Error cancelling command on page leave:",t.t0);case 15:t.next=18;break;case 17:console.log("No active command UUID to cancel on page leave");case 18:o.showingConnectionPrompt=!1,o.jitInProgress=!1,o.isPending=!1,clearTimeout(o.fetchTimeout),window.removeEventListener("beforeunload",o.handleBeforeUnload),n(),t.next=29;break;case 26:t.prev=26,t.t1=t["catch"](2),n(!1);case 29:case"end":return t.stop()}}),t,null,[[2,26],[6,12]])})))()}},C=b,I=(n("696f"),n("ecc2"),n("2877")),E=Object(I["a"])(C,o,i,!1,null,"ba423bd4",null);e["default"]=E.exports},d203:function(t,e,n){},ecc2:function(t,e,n){"use strict";n("d203")},f8d7:function(t,e,n){}}]);
//# sourceMappingURL=chunk-653eedf5.18391eb3.js.map